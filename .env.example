# ====================================
# ONLINETEST CONFIGURATION
# ====================================
# This file is for deploying with Docker Compose (all services in containers).
# Copy this file to .env and change all CHANGE_ME passwords before starting.
#
# To start:
# docker compose -f docker-compose.dependencies.yml -f docker-compose.server.yml -f docker-compose.testrunner.yml up
#
# For local Node.js development (server/testrunner on host, dependencies in
# Docker), use .env.example.local instead.

# ====================================
# PASSWORDS
# ====================================
# Change all of these before first start.
# Recommendation: Use at least 16 characters.
# Example generator: openssl rand -base64 24
#
# IMPORTANT: The Redis password must also be updated in redis-conf/redis.conf
# (the "requirepass" line). Docker Compose mounts that file directly, so the
# password in .env and redis.conf must match.
REDIS_PASSWORD=CHANGE_ME_REDIS_PASSWORD
POSTGRESQL_PASSWORD=CHANGE_ME_POSTGRES_PASSWORD
MINIO_PASSWORD=CHANGE_ME_MINIO_PASSWORD
ADMIN_BASICAUTH_PASSWORD=CHANGE_ME_ADMIN_PASSWORD

# ====================================
# REDIS / MESSAGE BROKER
# ====================================
# "redis" is the Docker Compose service name.
REDIS_HOST=redis
REDIS_DOCKER_VERSION=8.2.2

# ====================================
# DATABASE
# ====================================
# "postgresql" is the Docker Compose service name.
POSTGRESQL_USER=sitespeedio
POSTGRESQL_DB=sitespeedio
POSTGRESQL_HOST=postgresql
POSTGRESQL_PORT=5432
POSTGRESQL_DOCKER_VERSION=16.11

# ====================================
# OBJECT STORAGE (MinIO / S3)
# ====================================
# "minio" is the Docker Compose service name.
MINIO_HOST=minio
MINIO_PORT=9000
MINIO_USER=sitespeedio
MINIO_DOCKER_VERSION=RELEASE.2025-09-07T16-13-09Z
MINIO_MC_DOCKER_VERSION=RELEASE.2025-08-13T08-35-41Z

# ====================================
# DOMAIN VALIDATION
# ====================================
# Regular expression that must match every URL submitted for testing.
# This prevents abuse of public-facing instances.
#
# Allow only your specific domains:
# VALID_TEST_DOMAINS=^https?://(.*\.)?(example\.com|mysite\.org)
#
# Allow multiple domains with subdomains:
# VALID_TEST_DOMAINS=^https?://(.*\.)?(example\.com|anothersite\.net|thirdsite\.org)
#
# Allow only specific subdomains:
# VALID_TEST_DOMAINS=^https?://(www\.|staging\.)example\.com
#
# Allow all domains (USE ONLY FOR PRIVATE/INTERNAL INSTANCES):
VALID_TEST_DOMAINS=.*

# ====================================
# SERVER
# ====================================
# GUI language. See server/locales/ for available locales.
LOCALIZATION_LOCALE=en

# Admin panel login (separate from site-wide basic auth).
ADMIN_BASICAUTH_LOGIN=admin

# The URL shown in the sitespeed.io HTML report to link back to the server.
SITESPEED.IO_HTML_HOMEURL="http://127.0.0.1:3000/"

# ====================================
# SERVER & TESTRUNNER DOCKER IMAGES
# ====================================
# Only used by docker-compose.server.yml and docker-compose.testrunner.yml.
SITESPEED_IO_SERVER_VERSION=2
SITESPEED_IO_TESTRUNNER_VERSION=2

# ====================================
# TESTRUNNER
# ====================================
# The testrunner location name. Must match a location in
# testrunner/config/testrunner.yaml.
LOCATION_NAME="default"

# The sitespeed.io Docker image the testrunner uses to run tests.
# Pin to a specific version for reproducibility in production.
SITESPEED_IO_CONTAINER=sitespeedio/sitespeed.io:39
# SITESPEED_IO_CONTAINER=sitespeedio/sitespeed.io:39.0.0

# The S3/MinIO endpoint as seen from inside the Docker network.
# In Docker Compose this is the minio service name.
SITESPEED_IO_S3_ENDPOINT="http://minio:9000"

# ====================================
# RESULT STORAGE & ACCESS
# ====================================
# The public base URL where test results are accessible in a browser.
# For production, point this at your MinIO/S3 domain:
# RESULT_BASE_URL="https://results.yourdomain.com/sitespeedio"
RESULT_BASE_URL="http://127.0.0.1:9000/sitespeedio"

# ====================================
# NETWORKING (Linux only)
# ====================================
# For network throttling on Linux, load the ifb module:
#   sudo modprobe ifb numifbs=1
# macOS can only use "native" connectivity when running Docker containers.

